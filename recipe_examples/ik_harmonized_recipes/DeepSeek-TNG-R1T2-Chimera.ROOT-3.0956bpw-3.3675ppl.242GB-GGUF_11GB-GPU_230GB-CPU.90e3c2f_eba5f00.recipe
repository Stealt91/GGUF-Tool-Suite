## Quant mix recipe created using Thireus' GGUF Tool Suite - https://gguf.thireus.com/
# Model name: DeepSeek-TNG-R1T2-Chimera
# Link to the original model: https://huggingface.co/tngtech/DeepSeek-TNG-R1T2-Chimera

## Model head & embeddings — qbits: 32 8 
^output_norm\.weight$=f32
^token_embd\.weight$=q8_0
^output\.weight$=q8_0

## Special attention kernels — single-quant only (llama-quantize takes care of it) — qbits: 8 
^blk\.([0-9]|[1-5][0-9]|60)\.attn_k_b\.weight$=q8_0

## Multi-headed attention parameters — qbits: 32 4 
^blk\.([0-9]|[1-5][0-9]|60)\.attn_q_b\.weight$=iq4_xs
^blk\.([0-9]|[1-5][0-9]|60)\.attn_q_a\.weight$=iq4_xs
^blk\.([0-9]|[1-5][0-9]|60)\.attn_kv_b\.weight$=iq4_xs
^blk\.([0-9]|[1-5][0-9]|60)\.attn_kv_a_norm\.weight$=f32
^blk\.([0-9]|[1-5][0-9]|60)\.attn_output\.weight$=iq4_xs
^blk\.([0-9]|[1-5][0-9]|60)\.attn_v_b\.weight$=iq4_xs
^blk\.([0-9]|[1-5][0-9]|60)\.attn_q_a_norm\.weight$=f32
^blk\.([0-9]|[1-5][0-9]|60)\.attn_kv_a_mqa\.weight$=iq4_xs
^blk\.([0-9]|[1-5][0-9]|60)\.attn_norm\.weight$=f32

## Core FFN weights — qbits: 32 8 6 5 
^blk\.([3-9]|[1-5][0-9]|60)\.ffn_gate_inp\.weight$=f32
^blk\.1\.ffn_down\.weight$=iq6_k
^blk\.0\.ffn_gate\.weight$=iq5_k_r4
^blk\.([0-9]|[1-5][0-9]|60)\.ffn_norm\.weight$=f32
^blk\.0\.ffn_down\.weight$=q8_0
^blk\.2\.ffn_gate\.weight$=q8_0
^blk\.2\.ffn_down\.weight$=iq5_k_r4
^blk\.1\.ffn_gate\.weight$=iq6_k
^blk\.[1-2]\.ffn_up\.weight$=iq6_k
^blk\.0\.ffn_up\.weight$=q8_0

## Other tensors — qbits: 32 
^blk\.([3-9]|[1-5][0-9]|60)\.exp_probs_b\.bias$=f32

## GPU-loaded ffn_*_shexp
# ffn_down_shexp (down-projection) — qbits: 8 6 5 
^blk\.([4-6]|8|11|14|17|2[1-3]|2[5-9]|32|37|40|50|60)\.ffn_down_shexp\.weight$=q8_0
^blk\.(3|7|9|10|12|1[5-6]|19|20|24|3[0-1]|3[3-6]|3[8-9]|4[1-5]|4[8-9]|51|57)\.ffn_down_shexp\.weight$=iq6_k
^blk\.(13|18|4[6-7]|5[2-6]|5[8-9])\.ffn_down_shexp\.weight$=iq5_k_r4

# ffn_up_shexp (up-projection) — qbits: 8 6 5 
^blk\.([3-7]|9|12|14|21|29|32|3[7-8]|42|45|60)\.ffn_up_shexp\.weight$=q8_0
^blk\.(8|1[0-1]|13|15|18|20|2[2-8]|3[0-1]|3[3-6]|39|4[0-1]|4[3-4]|4[6-8]|5[0-1]|5[3-4]|58)\.ffn_up_shexp\.weight$=iq6_k
^blk\.(1[6-7]|19|49|52|5[5-7]|59)\.ffn_up_shexp\.weight$=iq5_k_r4

# ffn_gate_shexp (gate-projection) — qbits: 8 6 5 
^blk\.([4-6]|8|1[3-5]|1[7-8]|24|26|29|34|3[6-9]|49|60)\.ffn_gate_shexp\.weight$=q8_0
^blk\.(3|7|9|10|12|16|19|2[0-1]|23|25|2[7-8]|3[0-3]|35|4[0-1]|4[3-8]|5[0-2]|5[4-8])\.ffn_gate_shexp\.weight$=iq6_k
^blk\.(11|22|42|53|59)\.ffn_gate_shexp\.weight$=iq5_k_r4

## CPU-friendly ffn_*_exps
# ffn_down_exps (down-extraction) — qbits: 4 3 2 1 
^blk\.(3[2-3]|4[0-9]|3[5-9]|51)\.ffn_down_exps\.weight$=iq4_ks
^blk\.(1[0-2]|18|2[0-8]|3[0-1]|34|50|5[2-8]|60)\.ffn_down_exps\.weight$=iq3_k
^blk\.([3-4]|[6-7]|14|17|19|29|59)\.ffn_down_exps\.weight$=iq2_k
^blk\.(5|[8-9]|13|1[5-6])\.ffn_down_exps\.weight$=iq1_m_r4

# ffn_up_exps (up-extraction) — qbits: 4 3 2 1 
^blk\.(48|51)\.ffn_up_exps\.weight$=iq4_ks
^blk\.(22|24|27|3[2-3]|3[5-9]|4[0-7]|49|50|5[2-5]|5[7-9]|60)\.ffn_up_exps\.weight$=iq3_k
^blk\.(5|[8-9]|1[1-3]|1[5-6]|18|2[0-1]|23|2[5-6]|2[8-9]|3[0-1]|34|56)\.ffn_up_exps\.weight$=iq2_k
^blk\.([3-4]|[6-7]|10|14|17|19)\.ffn_up_exps\.weight$=iq1_m_r4

# ffn_gate_exps (gate-extraction) — qbits: 4 3 2 1 
^blk\.(48|51)\.ffn_gate_exps\.weight$=iq4_ks
^blk\.(22|24|27|3[2-3]|3[5-9]|4[0-7]|49|50|5[2-5]|5[7-9]|60)\.ffn_gate_exps\.weight$=iq3_k
^blk\.(5|[8-9]|1[1-3]|1[5-6]|18|2[0-1]|23|2[5-6]|2[8-9]|3[0-1]|34|56)\.ffn_gate_exps\.weight$=iq2_k
^blk\.([3-4]|[6-7]|10|14|17|19)\.ffn_gate_exps\.weight$=iq1_m_r4

## Summary of tensor sizes per class
# GPU Total: 11.708 GiB (94.8%) | 12.34 GiB max, if all were q8_0 | 10.39 GiB min, if all were iq5_k_r4
# CPU Total: 230.480 GiB (71.2%) | 323.53 GiB max, if all were iq4_ks | 133.22 GiB min, if all were iq1_m_r4
# GPU+CPU Total: 242.188 GiB (83.0%)

## Summary of tensor counts and bpw per qtype
#
# GPU-loaded quants:
# QTYPE		Count	BPW	Assigned GiB	% Assigned	Max GiB (all)
# +f32       	361	32.0  	  0.40 GiB	-		-
# +q8_0      	61 	8.5   	  0.51 GiB	-		-
# q8_0      	60 	8.5   	  3.03 GiB	54.6%		5.54
# iq6_k     	98 	6.625 	  1.47 GiB	34.1%		4.32
# iq5_k_r4  	27 	5.5   	  0.40 GiB	11.3%		3.58
# +iq4_xs    	366	4.25  	  5.90 GiB	-		-
#
# CPU-friendly quants:
# QTYPE		Count	BPW	Assigned GiB	% Assigned	Max GiB (all)
# iq4_ks    	22 	4.25  	 40.91 GiB	12.6%		323.53
# iq3_k     	81 	3.4375	121.82 GiB	46.6%		261.68
# iq2_k     	49 	2.375 	 50.91 GiB	28.2%		180.80
# iq1_m_r4  	22 	1.75  	 16.84 GiB	12.6%		133.22
#
# -Average BPW: 3.0956
#
# -Notes:
# - '+' means user-defined pre-assigned tensors, or tensor missing from csv data or f32 tensors
# - Recipe produced on the 2025-09-03 16:35:07 UTC+0000 using Thireus' GGUF tools (https://gguf.thireus.com/)
# - Script SHA-256: 90e3c2fafeb4aa4360e9fed16bf2aa8f5be90c24da90bd656f38ca48bf77bd1d
# - Calibration dataset 'ppl_results.csv' SHA-256: 07363eb6f0d89ef0e87810860dfb92cbad5948388f36a8608963aa093aaa825f
# - tensors.bf16.map SHA-256: 7e14a029773982c26a580c1d121eac70887dbadf97618371de21635bcff2b982
# - tensors.bf16.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-BF16-SPECIAL_TENSOR-01148-of-01148
# - tensors.iq4_ks.map SHA-256: 79bf2bce906e71d1c82a31c92fa79d9e3c1735e3deb3f861ef685675a0d5e0db
# - tensors.iq4_ks.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-IQ4_KS-SPECIAL_TENSOR-01148-of-01148
# - tensors.iq3_k.map SHA-256: b8faa8da4cb4a03e39eb3e349c64fbfde007added0d5b94c6e8beede97537224
# - tensors.iq3_k.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-IQ3_K-SPECIAL_TENSOR-01148-of-01148
# - tensors.iq2_k.map SHA-256: 3743de85e007fd904b40e71cf699ce5be40f6c6cdb1f5d828c75b2da8f9cde30
# - tensors.iq2_k.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-IQ2_K-SPECIAL_TENSOR-01148-of-01148
# - tensors.iq1_m_r4.map SHA-256: d6fb21a8db1492d3827442757cde5e5e9c5da7ed676c2fd9d3a8e4e99813de9f
# - tensors.iq1_m_r4.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-IQ1_M_R4-SPECIAL_TENSOR-01148-of-01148
# - tensors.q8_0.map SHA-256: 1133d47c9f6803e4f7cd3596e413467a7f7859403db8283a5b348552469356a0
# - tensors.q8_0.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-Q8_0-SPECIAL_TENSOR-01148-of-01148
# - tensors.iq5_k_r4.map SHA-256: f0840b1a8f935eedc7745a42b7acfd66f5b4376751c5d6ef50488c07813aa226
# - tensors.iq5_k_r4.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-IQ5_K_R4-SPECIAL_TENSOR-01148-of-01148
# - tensors.iq6_k.map SHA-256: 13994f4a0ce464f0e5f583c12a4258569c6ec7edd42c5212ced824a954c63698
# - tensors.iq6_k.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-IQ6_K-SPECIAL_TENSOR-01148-of-01148
# - tensors.iq4_xs.map SHA-256: e6586635ad85034329b4238b715ee3548a37a9816cd308296d01ef18fb9ce29f
# - tensors.iq4_xs.map model name: DeepSeek-TNG-R1T2-Chimera-THIREUS-IQ4_XS-SPECIAL_TENSOR-01148-of-01148
# - GPG signatures: PASSED
# - Command used:
# ../../quant_assign.py ppl_results.csv --tolerance 0.01 --cpu-irq-k 1.5 --gpu-irq-k 1.5 --gpu-assign-qtype iq4_xs \
# --cpu-tensors-max-size 230 --gpu-tensors-max-size 95% --exponential-factor 8 --cpu-tensors \
# 'blk\.([3-9]|[1-5][0-9]|60)\.ffn_down_exps\.weight' 'blk\.([3-9]|[1-5][0-9]|60)\.ffn_up_exps\.weight' \
# 'blk\.([3-9]|[1-5][0-9]|60)\.ffn_gate_exps\.weight' --gpu-tensors '.*' --cpu-quants iq4_ks iq3_k iq2_k iq1_m_r4 \
# --gpu-quants q8_0 iq5_k_r4 iq6_k --gpu-assign-tensors 'blk\.([0-9]|[1-5][0-9]|60)\.attn_k_b\.weight=q8_0' \
# --harmonize-tensors '^blk\..*\.ffn_up_exps.*,blk\..*\.ffn_gate_exps.*' --harmonization-technique 3

## THE END!

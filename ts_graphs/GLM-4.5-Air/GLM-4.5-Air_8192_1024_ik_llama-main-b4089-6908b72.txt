llama_model_loader: max stdio successfully set to 2048
llama_model_loader: additional 803 GGUFs metadata loaded.
llama_model_loader: loaded meta data with 44 key-value pairs and 803 tensors from GLM-4.5-Air-THIREUS-BF16-SPECIAL_TENSOR-00001-of-00804.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = glm4moe
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = GLM 4.5 Air
llama_model_loader: - kv   3:                         general.size_label str              = 128x9.4B
llama_model_loader: - kv   4:                            general.license str              = mit
llama_model_loader: - kv   5:                               general.tags arr[str,1]       = ["text-generation"]
llama_model_loader: - kv   6:                          general.languages arr[str,2]       = ["en", "zh"]
llama_model_loader: - kv   7:                        glm4moe.block_count u32              = 47
llama_model_loader: - kv   8:                     glm4moe.context_length u32              = 131072
llama_model_loader: - kv   9:                   glm4moe.embedding_length u32              = 4096
llama_model_loader: - kv  10:                glm4moe.feed_forward_length u32              = 10944
llama_model_loader: - kv  11:               glm4moe.attention.head_count u32              = 96
llama_model_loader: - kv  12:            glm4moe.attention.head_count_kv u32              = 8
llama_model_loader: - kv  13:                     glm4moe.rope.freq_base f32              = 1000000.000000
llama_model_loader: - kv  14:   glm4moe.attention.layer_norm_rms_epsilon f32              = 0.000010
llama_model_loader: - kv  15:                  glm4moe.expert_used_count u32              = 8
llama_model_loader: - kv  16:               glm4moe.attention.key_length u32              = 128
llama_model_loader: - kv  17:             glm4moe.attention.value_length u32              = 128
llama_model_loader: - kv  18:                          general.file_type u32              = 24
llama_model_loader: - kv  19:               glm4moe.rope.dimension_count u32              = 64
llama_model_loader: - kv  20:                       glm4moe.expert_count u32              = 128
llama_model_loader: - kv  21:         glm4moe.expert_feed_forward_length u32              = 1408
llama_model_loader: - kv  22:                glm4moe.expert_shared_count u32              = 1
llama_model_loader: - kv  23:          glm4moe.leading_dense_block_count u32              = 1
llama_model_loader: - kv  24:                 glm4moe.expert_gating_func u32              = 2
llama_model_loader: - kv  25:               glm4moe.expert_weights_scale f32              = 1.000000
llama_model_loader: - kv  26:                glm4moe.expert_weights_norm bool             = true
llama_model_loader: - kv  27:               glm4moe.nextn_predict_layers u32              = 1
llama_model_loader: - kv  28:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  29:                         tokenizer.ggml.pre str              = glm4
llama_model_loader: - kv  30:                      tokenizer.ggml.tokens arr[str,151552]  = ["!", "\"", "#", "$", "%", "&", "'", ...
llama_model_loader: - kv  31:                  tokenizer.ggml.token_type arr[i32,151552]  = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  32:                      tokenizer.ggml.merges arr[str,318088]  = ["Ġ Ġ", "Ġ ĠĠĠ", "ĠĠ ĠĠ", "...
llama_model_loader: - kv  33:                tokenizer.ggml.eos_token_id u32              = 151329
llama_model_loader: - kv  34:            tokenizer.ggml.padding_token_id u32              = 151329
llama_model_loader: - kv  35:                tokenizer.ggml.bos_token_id u32              = 151331
llama_model_loader: - kv  36:                tokenizer.ggml.eot_token_id u32              = 151336
llama_model_loader: - kv  37:            tokenizer.ggml.unknown_token_id u32              = 151329
llama_model_loader: - kv  38:                tokenizer.ggml.eom_token_id u32              = 151338
llama_model_loader: - kv  39:                    tokenizer.chat_template str              = [gMASK]<sop>\n{%- if tools -%}\n<|syste...
llama_model_loader: - kv  40:               general.quantization_version u32              = 2
llama_model_loader: - kv  41:                                   split.no u16              = 0
llama_model_loader: - kv  42:                                split.count u16              = 804
llama_model_loader: - kv  43:                        split.tensors.count i32              = 803
llama_model_loader: - type  f32:  331 tensors
llama_model_loader: - type q8_0:   48 tensors
llama_model_loader: - type q5_K:    1 tensors
llama_model_loader: - type iq3_xxs:  186 tensors
llama_model_loader: - type iq4_nl:   93 tensors
llama_model_loader: - type iq4_xs:  144 tensors
init_tokenizer: initializing tokenizer for type 2
load: control token: 151334 '<eop>' is not marked as EOG
load: control token: 151331 '[gMASK]' is not marked as EOG
load: control token: 151362 '<|end_of_box|>' is not marked as EOG
load: control token: 151343 '<|begin_of_audio|>' is not marked as EOG
load: control token: 151335 '<|system|>' is not marked as EOG
load: control token: 151345 '<|begin_of_transcription|>' is not marked as EOG
load: control token: 151344 '<|end_of_audio|>' is not marked as EOG
load: control token: 151336 '<|user|>' is not marked as EOG
load: control token: 151332 '[sMASK]' is not marked as EOG
load: control token: 151346 '<|end_of_transcription|>' is not marked as EOG
load: control token: 151330 '[MASK]' is not marked as EOG
load: control token: 151333 '<sop>' is not marked as EOG
load: control token: 151337 '<|assistant|>' is not marked as EOG
load: control token: 151338 '<|observation|>' is not marked as EOG
load: control token: 151339 '<|begin_of_image|>' is not marked as EOG
load: control token: 151340 '<|end_of_image|>' is not marked as EOG
load: control token: 151341 '<|begin_of_video|>' is not marked as EOG
load: control token: 151342 '<|end_of_video|>' is not marked as EOG
load: control token: 151347 '<|code_prefix|>' is not marked as EOG
load: control token: 151348 '<|code_middle|>' is not marked as EOG
load: control token: 151349 '<|code_suffix|>' is not marked as EOG
load: control token: 151360 '/nothink' is not marked as EOG
load: control token: 151361 '<|begin_of_box|>' is not marked as EOG
load: control token: 151363 '<|image|>' is not marked as EOG
load: control token: 151364 '<|video|>' is not marked as EOG
load: special_eot_id is not in special_eog_ids - the tokenizer config may be incorrect
load: special_eom_id is not in special_eog_ids - the tokenizer config may be incorrect
load: printing all EOG tokens:
load:   - 151329 ('<|endoftext|>')
load:   - 151336 ('<|user|>')
load:   - 151338 ('<|observation|>')
load: special tokens cache size = 36
load: token to piece cache size = 0.9713 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = glm4moe
llm_load_print_meta: n_ctx_train      = 131072
llm_load_print_meta: n_embd           = 4096
llm_load_print_meta: n_layer          = 47
llm_load_print_meta: n_head           = 96
llm_load_print_meta: n_head_kv        = 8
llm_load_print_meta: n_rot            = 64
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_swa_pattern    = 1
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 12
llm_load_print_meta: n_embd_k_gqa     = 1024
llm_load_print_meta: n_embd_v_gqa     = 1024
llm_load_print_meta: f_norm_eps       = 0.0e+00
llm_load_print_meta: f_norm_rms_eps   = 1.0e-05
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 10944
llm_load_print_meta: n_expert         = 128
llm_load_print_meta: n_expert_used    = 8
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 1000000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 131072
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: model type       = 106B.A12B
llm_load_print_meta: model ftype      = IQ1_S - 1.5625 bpw
llm_load_print_meta: model params     = 110.469 B
llm_load_print_meta: model size       = 47.828 GiB (3.719 BPW) 
llm_load_print_meta: repeating layers = 46.817 GiB (3.682 BPW, 109.227 B parameters)
llm_load_print_meta: general.name     = GLM 4.5 Air
print_info: vocab type       = BPE
print_info: n_vocab          = 151552
print_info: n_merges         = 318088
print_info: BOS token        = 151331 '[gMASK]'
print_info: EOS token        = 151329 '<|endoftext|>'
print_info: EOT token        = 151336 '<|user|>'
print_info: EOM token        = 151338 '<|observation|>'
print_info: UNK token        = 151329 '<|endoftext|>'
print_info: PAD token        = 151329 '<|endoftext|>'
print_info: LF token         = 198 'Ċ'
print_info: FIM PRE token    = 151347 '<|code_prefix|>'
print_info: FIM SUF token    = 151349 '<|code_suffix|>'
print_info: FIM MID token    = 151348 '<|code_middle|>'
print_info: EOG token        = 151329 '<|endoftext|>'
print_info: EOG token        = 151336 '<|user|>'
print_info: EOG token        = 151338 '<|observation|>'
print_info: max token length = 1024
ggml_cuda_init: GGML_CUDA_FORCE_MMQ:    no
ggml_cuda_init: GGML_CUDA_FORCE_CUBLAS: no
ggml_cuda_init: found 1 CUDA devices:
  Device 0: NVIDIA RTX PRO 6000 Blackwell Workstation Edition, compute capability 12.0, VMM: yes
llm_load_tensors: ggml ctx size =    0.66 MiB
model has unused tensor blk.46.attn_norm.weight (size = 16384 bytes) -- ignoring
model has unused tensor blk.46.attn_q.weight (size = 26738688 bytes) -- ignoring
model has unused tensor blk.46.attn_k.weight (size = 2228224 bytes) -- ignoring
model has unused tensor blk.46.attn_v.weight (size = 2228224 bytes) -- ignoring
model has unused tensor blk.46.attn_q.bias (size = 49152 bytes) -- ignoring
model has unused tensor blk.46.attn_k.bias (size = 4096 bytes) -- ignoring
model has unused tensor blk.46.attn_v.bias (size = 4096 bytes) -- ignoring
model has unused tensor blk.46.attn_output.weight (size = 53477376 bytes) -- ignoring
model has unused tensor blk.46.post_attention_norm.weight (size = 16384 bytes) -- ignoring
model has unused tensor blk.46.ffn_gate_inp.weight (size = 2097152 bytes) -- ignoring
model has unused tensor blk.46.exp_probs_b.bias (size = 512 bytes) -- ignoring
model has unused tensor blk.46.ffn_gate_exps.weight (size = 282591232 bytes) -- ignoring
model has unused tensor blk.46.ffn_down_exps.weight (size = 415236096 bytes) -- ignoring
model has unused tensor blk.46.ffn_up_exps.weight (size = 282591232 bytes) -- ignoring
model has unused tensor blk.46.ffn_gate_shexp.weight (size = 2207744 bytes) -- ignoring
model has unused tensor blk.46.ffn_down_shexp.weight (size = 3244032 bytes) -- ignoring
model has unused tensor blk.46.ffn_up_shexp.weight (size = 2207744 bytes) -- ignoring
model has unused tensor blk.46.nextn.eh_proj.weight (size = 17825792 bytes) -- ignoring
model has unused tensor blk.46.nextn.embed_tokens.weight (size = 329777152 bytes) -- ignoring
model has unused tensor blk.46.nextn.enorm.weight (size = 16384 bytes) -- ignoring
model has unused tensor blk.46.nextn.hnorm.weight (size = 16384 bytes) -- ignoring
model has unused tensor blk.46.nextn.shared_head_head.weight (size = 329777152 bytes) -- ignoring
model has unused tensor blk.46.nextn.shared_head_norm.weight (size = 16384 bytes) -- ignoring
llm_load_tensors: offloading 47 repeating layers to GPU
llm_load_tensors: offloading non-repeating layers to GPU
llm_load_tensors: offloaded 48/48 layers to GPU
llm_load_tensors:  CUDA_Host buffer size =   407.00 MiB
llm_load_tensors:      CUDA0 buffer size = 46897.99 MiB
...................................................................................................
llama_new_context_with_model: n_ctx      = 65536
llama_new_context_with_model: n_batch    = 8192
llama_new_context_with_model: n_ubatch   = 1024
llama_new_context_with_model: flash_attn = 1
llama_new_context_with_model: mla_attn   = 0
llama_new_context_with_model: attn_max_b = 0
llama_new_context_with_model: fused_moe  = 1
llama_new_context_with_model: ser        = -1, 0
llama_new_context_with_model: freq_base  = 1000000.0
llama_new_context_with_model: freq_scale = 1
llama_kv_cache_init:      CUDA0 KV buffer size = 12032.00 MiB
llama_new_context_with_model: KV self size  = 12032.00 MiB, K (f16): 6016.00 MiB, V (f16): 6016.00 MiB
llama_new_context_with_model:  CUDA_Host  output buffer size =     0.58 MiB
llama_new_context_with_model:      CUDA0 compute buffer size =   608.00 MiB
llama_new_context_with_model:  CUDA_Host compute buffer size =   272.01 MiB
llama_new_context_with_model: graph nodes  = 2149
llama_new_context_with_model: graph splits = 2

main: n_kv_max = 65536, n_batch = 8192, n_ubatch = 1024, flash_attn = 1, n_gpu_layers = 99, n_threads = 36, n_threads_batch = 36

|    PP |     TG |   N_KV |   T_PP s | S_PP t/s |   T_TG s | S_TG t/s |
|-------|--------|--------|----------|----------|----------|----------|
|  1024 |    256 |      0 |    0.660 |  1552.67 |    2.790 |    91.75 |
|  1024 |    256 |   1024 |    0.667 |  1534.61 |    2.835 |    90.29 |
|  1024 |    256 |   2048 |    0.687 |  1490.92 |    2.878 |    88.96 |
|  1024 |    256 |   3072 |    0.707 |  1447.98 |    2.928 |    87.43 |
|  1024 |    256 |   4096 |    0.722 |  1418.72 |    3.048 |    83.99 |
|  1024 |    256 |   5120 |    0.732 |  1399.55 |    3.103 |    82.49 |
|  1024 |    256 |   6144 |    0.747 |  1369.97 |    3.184 |    80.40 |
|  1024 |    256 |   7168 |    0.767 |  1335.13 |    3.236 |    79.12 |
|  1024 |    256 |   8192 |    0.805 |  1272.69 |    3.331 |    76.86 |
|  1024 |    256 |   9216 |    0.816 |  1255.42 |    3.387 |    75.59 |
|  1024 |    256 |  10240 |    0.841 |  1217.78 |    3.460 |    73.99 |
|  1024 |    256 |  11264 |    0.852 |  1201.27 |    3.508 |    72.97 |
|  1024 |    256 |  12288 |    0.886 |  1156.33 |    3.635 |    70.42 |
|  1024 |    256 |  13312 |    0.887 |  1154.64 |    3.658 |    69.98 |
|  1024 |    256 |  14336 |    0.900 |  1137.23 |    3.677 |    69.62 |
|  1024 |    256 |  15360 |    0.908 |  1127.20 |    3.728 |    68.66 |
|  1024 |    256 |  16384 |    0.921 |  1111.72 |    3.807 |    67.24 |
|  1024 |    256 |  17408 |    0.946 |  1081.97 |    3.890 |    65.82 |
|  1024 |    256 |  18432 |    0.961 |  1065.18 |    3.959 |    64.66 |
|  1024 |    256 |  19456 |    0.991 |  1033.35 |    4.006 |    63.90 |
|  1024 |    256 |  20480 |    0.997 |  1026.85 |    4.178 |    61.28 |
|  1024 |    256 |  21504 |    1.020 |  1003.83 |    4.220 |    60.67 |
|  1024 |    256 |  22528 |    1.039 |   985.73 |    4.282 |    59.79 |
|  1024 |    256 |  23552 |    1.059 |   967.01 |    4.334 |    59.06 |
|  1024 |    256 |  24576 |    1.063 |   963.76 |    4.431 |    57.77 |
|  1024 |    256 |  25600 |    1.079 |   948.89 |    4.415 |    57.99 |
|  1024 |    256 |  26624 |    1.118 |   915.88 |    4.454 |    57.47 |
|  1024 |    256 |  27648 |    1.131 |   905.33 |    4.484 |    57.09 |
|  1024 |    256 |  28672 |    1.136 |   901.61 |    4.603 |    55.61 |
|  1024 |    256 |  29696 |    1.159 |   883.74 |    4.661 |    54.92 |
|  1024 |    256 |  30720 |    1.176 |   870.63 |    4.720 |    54.24 |
|  1024 |    256 |  31744 |    1.214 |   843.43 |    4.787 |    53.48 |
|  1024 |    256 |  32768 |    1.245 |   822.30 |    4.927 |    51.96 |
|  1024 |    256 |  33792 |    1.259 |   813.54 |    5.080 |    50.39 |
|  1024 |    256 |  34816 |    1.291 |   793.25 |    5.431 |    47.13 |
|  1024 |    256 |  35840 |    1.309 |   782.38 |    6.044 |    42.36 |
|  1024 |    256 |  36864 |    1.320 |   775.48 |    6.087 |    42.06 |
|  1024 |    256 |  37888 |    1.337 |   765.75 |    6.215 |    41.19 |
|  1024 |    256 |  38912 |    1.368 |   748.52 |    6.284 |    40.74 |
|  1024 |    256 |  39936 |    1.382 |   740.79 |    6.543 |    39.12 |
|  1024 |    256 |  40960 |    1.408 |   727.47 |    6.542 |    39.13 |
|  1024 |    256 |  41984 |    1.411 |   725.64 |    6.702 |    38.20 |
|  1024 |    256 |  43008 |    1.468 |   697.32 |    6.807 |    37.61 |
|  1024 |    256 |  44032 |    1.480 |   691.78 |    7.108 |    36.02 |
|  1024 |    256 |  45056 |    1.489 |   687.52 |    7.340 |    34.88 |
|  1024 |    256 |  46080 |    1.505 |   680.61 |    7.482 |    34.21 |
|  1024 |    256 |  47104 |    1.527 |   670.68 |    7.709 |    33.21 |
|  1024 |    256 |  48128 |    1.567 |   653.31 |    7.907 |    32.38 |
|  1024 |    256 |  49152 |    1.563 |   655.32 |    7.966 |    32.14 |
|  1024 |    256 |  50176 |    1.588 |   645.03 |    8.076 |    31.70 |
|  1024 |    256 |  51200 |    1.608 |   636.67 |    8.195 |    31.24 |
|  1024 |    256 |  52224 |    1.628 |   628.89 |    8.302 |    30.84 |
|  1024 |    256 |  53248 |    1.646 |   621.99 |    8.391 |    30.51 |
|  1024 |    256 |  54272 |    1.673 |   612.22 |    8.522 |    30.04 |
|  1024 |    256 |  55296 |    1.705 |   600.58 |    8.634 |    29.65 |
|  1024 |    256 |  56320 |    1.716 |   596.78 |    8.774 |    29.18 |
|  1024 |    256 |  57344 |    1.753 |   584.26 |    8.861 |    28.89 |
|  1024 |    256 |  58368 |    1.773 |   577.40 |    8.961 |    28.57 |
|  1024 |    256 |  59392 |    1.806 |   566.97 |    9.092 |    28.16 |
|  1024 |    256 |  60416 |    1.847 |   554.38 |    9.221 |    27.76 |
|  1024 |    256 |  61440 |    1.824 |   561.40 |    9.325 |    27.45 |
|  1024 |    256 |  62464 |    1.849 |   553.69 |    9.422 |    27.17 |
|  1024 |    256 |  63488 |    1.894 |   540.64 |    9.504 |    26.94 |
|  1024 |    256 |  64512 |    1.923 |   532.57 |    9.658 |    26.51 |
